(self.webpackChunkblaze_forms=self.webpackChunkblaze_forms||[]).push([[763],{2763:(e,t,l)=>{"use strict";l.r(t),l.d(t,{BlazeformsModule:()=>y});var s=l(8583),i=l(7310),n=l(9336),o=l(7716),a=l(2595),r=l(3065),u=l(5521);function d(e,t){if(1&e&&(o.ynx(0),o.TgZ(1,"div",2),o.TgZ(2,"h2",3),o._uU(3),o.qZA(),o._UZ(4,"app-exported-form",4),o.qZA(),o.BQk()),2&e){const e=o.oxw();o.xp6(3),o.Oqu(e.formDetail.name),o.xp6(1),o.Q6J("levelDetails",e.levelDetails)("isPublishPage",!0)("elements",e.elements)("initial",e.paymentDetails)("payments",e.payments)("config",e.formDetail)}}function h(e,t){1&e&&(o.ynx(0),o._uU(1," Need Login "),o.BQk())}function c(e,t){1&e&&o._uU(0," It's Loading ")}function m(e,t){if(1&e&&(o.YNc(0,h,2,0,"ng-container",0),o.YNc(1,c,1,0,"ng-template",null,5,o.W1O)),2&e){const e=o.MAs(2),t=o.oxw();o.Q6J("ngIf",t.needLogin)("ngIfElse",e)}}let v=(()=>{class e{constructor(e,t,l,s){this.http=e,this.store=t,this.routec=l,this.renderer=s,this.dataLoaded=!1,this.model={name:""},this.haveTabs=!1,this.active=0,this.allArr=[],this.obj={},this.submitted=!1,this.workSpaceName="",this.formDetail={},this.payments=[],this.needLogin=!1,this.levelDetails={},this.userInfoSubscription$=this.store.select(n.S8).subscribe(e=>{this.userInfo=e}),this.routec.params.subscribe(e=>{this.workSpaceName=e.workspaceName,this.getForm(e.workspaceName,e.formName,e.entry)}),this.globalListenFunc=this.renderer.listen("document","keypress",e=>{this.payments=[],this.extractAllLineItems(this.elements)})}getForm(e,t,l){var s,i;console.log(this.userInfo,l);const n={FormEntriesId:l||null,Id:null,Name:t,WorkSpaceName:e,userID:(null===(s=this.userInfo)||void 0===s?void 0:s.Id)?null===(i=this.userInfo)||void 0===i?void 0:i.Id:null};this.http.call("GetFormDesign","POST",n).subscribe(e=>{this.dataLoaded=!0;const t=localStorage.getItem("bforms");JSON.parse(t),this.needLogin="WorkFlow"===e.formType&&!this.userInfo,this.formDetail=Object.assign(Object.assign({},e),{workspaceName:this.workSpaceName}),this.elements=[...JSON.parse(e.miscellaneousJSON).levels||[],...JSON.parse(e.miscellaneousJSON).targetBuilderTools],this.paymentDetails=JSON.parse(e.miscellaneousJSON).paymentSetting,this.extractAllLineItems(this.elements),this.getLevelDetails(this.formDetail),console.log(this.payments)})}getLevelDetails(e){var t,l,s,i,n,o;console.log(e),this.levelDetails.toBeFilledById=null===(t=this.userInfo)||void 0===t?void 0:t.Id,this.levelDetails.toBeFilledByName=null===(l=this.userInfo)||void 0===l?void 0:l.name,e.formEntry?(console.log(JSON.parse(e.formEntry)),this.elements=JSON.parse(e.formEntry).savedElementsWithValue,this.levelDetails.disabledLevel=JSON.parse(e.formEntry).levelDetails.enabledLevelId,this.levelDetails.enabledLevelId=JSON.parse(e.formEntry).levelDetails.enabledLevelId,e.workFlowOwners.forEach(t=>{var l;(null===(l=null==t?void 0:t.levelId)||void 0===l?void 0:l.length)>0&&e.workFlowLevels.forEach(e=>{t.levelId===e.id&&(this.levelDetails.toBeFilled=e.id,this.levelDetails.enabledLevelId.push(e.id))})})):(this.levelDetails.enabledLevelId=[null===(i=null===(s=null==e?void 0:e.workFlowLevels)||void 0===s?void 0:s[0])||void 0===i?void 0:i.id],this.levelDetails.toBeFilled=null===(o=null===(n=null==e?void 0:e.workFlowLevels)||void 0===n?void 0:n[0])||void 0===o?void 0:o.id),console.log(this.levelDetails),console.log(this.elements)}extractAllLineItems(e){null==e||e.forEach(e=>{"payment"!==e.inputType&&"currency"!==e.inputType||(null==e?void 0:e.dependUpon)&&!this.checkForDependency(e,"dependUpon")||this.payments.push({name:e.name,value:e.value}),e.childSection&&this.extractAllLineItems(e.childSection),e.children&&this.extractAllLineItems(e.children)})}ngOnInit(){}checkForDependency(e,t){const l=null==e?void 0:e[t];if(!l)return!0;const s=this.elements.findIndex(e=>e.uiIndexId==l.elementId),i=this.elements[s].value;if("boolean"===l.type){if(l.isFilledOut)return"number"==typeof i?i>-1:i.length>0;if(l.isNotFilledOut)return 0===i||0===i.length}else{if(l.is)return i===l.value;if(l.isNot)return i!==l.value;if(l.contains)return null==i?void 0:i.toLowerCase().includes(l.value);if(l.doesNotContains)return!(null==i?void 0:i.toLowerCase().includes(l.value));if(l.endWith)return i.endsWith(l.value);if(l.doesNotEndWith)return i.endsWith(l.value);if(l.startWith)return i.startsWith(l.value);if(l.doesNotStartWith)return!i.startsWith(l.value)}return!1}checkForRDependency(e,t){const l=null==e?void 0:e[t];if(!l)return!1;const s=this.elements.findIndex(e=>e.uiIndexId==l.elementId),i=this.elements[s].value;if("boolean"===l.type){if(l.isFilledOut)return"number"==typeof i?i>-1:i.length>0;if(l.isNotFilledOut)return 0===i||0===i.length}else{if(l.is)return i===l.value;if(l.isNot)return i!==l.value;if(l.contains)return null==i?void 0:i.toLowerCase().includes(l.value);if(l.doesNotContains)return!(null==i?void 0:i.toLowerCase().includes(l.value));if(l.endWith)return i.endsWith(l.value);if(l.doesNotEndWith)return i.endsWith(l.value);if(l.startWith)return i.startsWith(l.value);if(l.doesNotStartWith)return!i.startsWith(l.value)}return!0}submitParentForm(e){let t="";this.haveTabs?this.allArr.forEach(e=>{e.forEach(e=>{t=t+e.name+"="+(e.value&&0!==e.value.length?e.value:"No_value")+"||"})}):this.elements.forEach(e=>{t=t+e.name+"="+(e.value&&0!==e.value.length?e.value:"No_value")+"||"}),console.log(t)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(a.O),o.Y36(r.yh),o.Y36(i.gz),o.Y36(o.Qsj))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-blazeforms"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["notLoaded",""],[1,"container-fluid"],[1,"text-center","form-heading","my-1"],[3,"levelDetails","isPublishPage","elements","initial","payments","config"],["elseTemplate",""]],template:function(e,t){if(1&e&&(o.YNc(0,d,5,7,"ng-container",0),o.YNc(1,m,3,2,"ng-template",null,1,o.W1O)),2&e){const e=o.MAs(2);o.Q6J("ngIf",t.dataLoaded&&!t.needLogin)("ngIfElse",e)}},directives:[s.O5,u.d],styles:[""]}),e})();const f=[{path:":workspaceName/:formName",component:v},{path:":workspaceName/:formName/:entry",component:v}];let p=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[i.Bz.forChild(f)],i.Bz]}),e})();var g=l(3679),I=l(526),N=l(4466);let y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[s.ez,I.IJ,g.u5,g.UX,N.m,p]]}),e})()}}]);